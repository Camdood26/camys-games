<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Alien Invaders</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
html,body{margin:0;background:#000;color:#fff;font-family:system-ui}
#ui{position:absolute;left:12px;top:8px;font-size:18px;z-index:10}
canvas{display:block;margin:48px auto 0;background:#111}

/* Touch controls */
#touch-controls{
  position:fixed;bottom:16px;left:50%;
  transform:translateX(-50%);
  display:flex;gap:16px;z-index:20
}
.tc-btn{
  width:80px;height:80px;font-size:32px;
  border-radius:14px;border:none;
  background:rgba(255,255,255,0.18);
  color:#fff
}
@media(pointer:fine){#touch-controls{display:none}}

/* Game over */
#gameOverScreen{
  position:fixed;inset:0;
  background:rgba(0,0,0,0.9);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:100;
}
#gameOverBox{
  background:#111;
  border:2px solid red;
  box-shadow:0 0 20px red;
  padding:24px;
  border-radius:12px;
  text-align:center;
}
</style>
</head>
<body>

<div id="ui">Score: 0<br>Level: 1</div>

<div id="touch-controls">
  <button class="tc-btn" id="btnLeft">âŸµ</button>
  <button class="tc-btn" id="btnFire">ðŸ”¥</button>
  <button class="tc-btn" id="btnRight">âŸ¶</button>
</div>

<div id="gameOverScreen">
  <div id="gameOverBox">
    <h2 style="color:red;margin-top:0">Game Over</h2>
    <button onclick="location.href='index.html'"
      style="padding:10px 18px;font-size:16px;background:#222;color:white;border:1px solid #555;border-radius:8px">
      Back to Home
    </button>
  </div>
</div>

<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
const ui=document.getElementById("ui");

let score=0,level=1;
let bullets=[],alienBullets=[],enemies=[],boss=null;
let keys={},touchLeft=false,touchRight=false,touchFire=false;
let running=true;

window.onkeydown=e=>keys[e.key]=true;
window.onkeyup=e=>keys[e.key]=false;

function updateUI(){ui.innerHTML=`Score: ${score}<br>Level: ${level}`}

/* Player */
const player={x:380,y:520,w:40,h:40,speed:5,cool:0};
function updatePlayer(){
  if(keys["ArrowLeft"]||touchLeft)player.x-=player.speed;
  if(keys["ArrowRight"]||touchRight)player.x+=player.speed;
  player.x=Math.max(0,Math.min(canvas.width-player.w,player.x));
  if(player.cool>0)player.cool--;
  if((keys[" "]||touchFire)&&player.cool===0){
    bullets.push({x:player.x+18,y:player.y});
    player.cool=18;
  }
}
function drawPlayer(){
  ctx.fillStyle="cyan";
  ctx.fillRect(player.x,player.y,player.w,player.h);
}

/* Bullets */
function updateBullets(){
  bullets.forEach(b=>b.y-=8);
  bullets=bullets.filter(b=>b.y>-20);
}
function drawBullets(){
  ctx.fillStyle="yellow";
  bullets.forEach(b=>ctx.fillRect(b.x,b.y,4,8));
}

/* Neon Alien */
function drawAlien(e){
  ctx.strokeStyle=e.color;
  ctx.lineWidth=2;
  ctx.shadowBlur=10;
  ctx.shadowColor=e.color;
  ctx.strokeRect(e.x,e.y,e.w,e.h);
  ctx.shadowBlur=0;
  if(e.frame){
    ctx.beginPath();
    ctx.moveTo(e.x,e.y+e.h);
    ctx.lineTo(e.x+e.w/2,e.y+e.h-6);
    ctx.lineTo(e.x+e.w,e.y+e.h);
    ctx.stroke();
  }
}

/* Aliens */
function spawnAliens(){
  enemies=[];
  const rows=Math.min(1+Math.floor(level/5),4);
  const colors=["#00f","#0f0","#a0f","#fa0"];
  for(let r=0;r<rows;r++){
    for(let c=0;c<8;c++){
      enemies.push({
        x:80+c*80,y:60+r*60,w:30,h:30,
        dir:1,speed:1+level*0.25,
        frame:0,color:colors[r]
      });
    }
  }
}
function updateAliens(){
  enemies.forEach(e=>{
    e.x+=e.speed*e.dir;
    if(e.x<0||e.x>canvas.width-e.w){e.dir*=-1;e.y+=20}
    e.frame^=1;
    if(Math.random()<0.002+level*0.001){
      alienBullets.push({x:e.x+15,y:e.y+30});
    }
  });
  bullets.forEach((b,bi)=>{
    enemies.forEach((e,ei)=>{
      if(b.x>e.x&&b.x<e.x+e.w&&b.y>e.y&&b.y<e.y+e.h){
        bullets.splice(bi,1);
        enemies.splice(ei,1);
        score+=10;
        updateUI();
      }
    });
  });
}
function drawAliens(){enemies.forEach(drawAlien)}

/* Alien bullets */
function updateAlienBullets(){
  alienBullets.forEach(b=>b.y+=5);
  alienBullets=alienBullets.filter(b=>b.y<620);
  alienBullets.forEach(b=>{
    if(b.x>player.x&&b.x<player.x+player.w&&b.y>player.y){
      gameOver();
    }
  });
}
function drawAlienBullets(){
  ctx.fillStyle="red";
  alienBullets.forEach(b=>ctx.fillRect(b.x,b.y,6,12));
}

/* Boss */
function spawnBoss(){
  const hp=120+level*40;
  boss={x:300,y:80,w:200,h:120,hp,maxHp:hp,dir:1,cool:0};
}
function updateBoss(){
  boss.x+=2*boss.dir;
  if(boss.x<0||boss.x>canvas.width-boss.w)boss.dir*=-1;
  if(boss.cool--<=0){
    alienBullets.push(
      {x:boss.x+40,y:boss.y+boss.h},
      {x:boss.x+boss.w-40,y:boss.y+boss.h}
    );
    boss.cool=40;
  }
  bullets.forEach((b,bi)=>{
    if(b.x>boss.x&&b.x<boss.x+boss.w&&b.y>boss.y){
      bullets.splice(bi,1);
      boss.hp-=10;
      if(boss.hp<=0){
        boss=null;
        score+=200;
        level++;
        spawnAliens();
        updateUI();
      }
    }
  });
}
function drawBoss(){
  ctx.fillStyle="#777";
  ctx.beginPath();
  ctx.ellipse(boss.x+100,boss.y+60,100,60,0,0,Math.PI*2);
  ctx.fill();
  ctx.fillStyle="red";
  ctx.beginPath();
  ctx.arc(boss.x+70,boss.y+50,6,0,Math.PI*2);
  ctx.arc(boss.x+130,boss.y+50,6,0,Math.PI*2);
  ctx.fill();
  ctx.fillStyle="red";
  ctx.fillRect(boss.x,boss.y-10,boss.w,6);
  ctx.fillStyle="lime";
  ctx.fillRect(boss.x,boss.y-10,boss.w*(boss.hp/boss.maxHp),6);
}

/* Game over */
function gameOver(){
  running=false;
  document.getElementById("gameOverScreen").style.display="flex";
}

/* Loop */
function loop(){
  if(!running)return;
  ctx.clearRect(0,0,800,600);
  updatePlayer();drawPlayer();
  updateBullets();drawBullets();
  if(boss){updateBoss();drawBoss()}
  else{updateAliens();drawAliens()}
  updateAlienBullets();drawAlienBullets();
  if(!boss&&enemies.length===0){
    level++;
    updateUI();
    if(level%5===0)spawnBoss();
    else spawnAliens();
  }
  requestAnimationFrame(loop);
}

/* Touch */
btnLeft.onpointerdown=()=>touchLeft=true;
btnLeft.onpointerup=()=>touchLeft=false;
btnRight.onpointerdown=()=>touchRight=true;
btnRight.onpointerup=()=>touchRight=false;
btnFire.onpointerdown=()=>touchFire=true;
btnFire.onpointerup=()=>touchFire=false;

/* Start */
spawnAliens();
updateUI();
loop();
</script>
</body>
</html>
